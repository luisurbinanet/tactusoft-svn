<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">

<ui:composition template="../templates/common.xhtml">

	<ui:define name="body">

		<p:panel style="width:100%;height:2000px;"
			header="#{msg['title_view_history']}">

			<p:spacer height="5" />

			<h:form id="form">

				<p:growl id="growl" showDetail="true" />

				<p:toolbar id="toolBar" style="width:100%">
					<p:toolbarGroup align="left">
						<p:commandButton value="#{msg['btn_add_patient']}"
							icon="ui-icon-circle-check" oncomplete="dlg2.show()"
							update=":editForm:dialog2" />
						<p:commandButton value="#{msg['btn_search']}"
							icon="ui-icon-search" update="toolBar tabView growl"
							actionListener="#{historyBacking.searchAction}" />
						<p:commandButton id="btnSavePatient"
							value="#{msg['btn_save_patient']}" icon="ui-icon-disk"
							action="#{historyBacking.savePatientAction}"
							update="toolBar growl tabView"
							disabled="#{historyBacking.disabledSaveButtonPatient}" />
						<p:commandButton id="btnSaveHistory"
							value="#{msg['btn_save_history']}" icon="ui-icon-disk"
							actionListener="#{historyBacking.saveAction}"
							update="toolBar growl tabView"
							disabled="#{historyBacking.disabledSaveButton}" />
					</p:toolbarGroup>
				</p:toolbar>

				<p:spacer height="5" />

				<h:panelGrid id="pnlDetail" columns="4" width="100%">
					<h:outputLabel value="#{msg['pat_sap_code']}" />
					<p:inputText value="#{historyBacking.selectedPatient.codeSap}"
						style="width:400px" readonly="true" />

					<h:outputLabel value="#{msg['pat_names']}" />
					<p:inputText value="#{historyBacking.selectedPatient.names}"
						style="width:400px" readonly="true" />
				</h:panelGrid>

				<p:spacer height="5" />

				<p:tabView id="tabView" style="height:100%">

					<p:tab id="tab1" title="#{msg['title_patient_complementary']}">
						<p:fieldset legend="#{msg['pat_personal_data']}">
							<h:panelGrid id="pnlDetail" columns="4" style="margin:0 auto;"
								width="100%">

								<h:outputLabel value="#{msg['pat_born_date']}" />
								<p:calendar value="#{historyBacking.selected.bornDate}"
									label="#{msg['pat_born_date']}" readonlyInput="true"
									pattern="dd/MM/yyyy" showOn="button" navigator="true"
									locale="es" yearRange="-100:+0"
									readonly="#{historyBacking.disabledSaveButtonPatient}" />

								<h:outputLabel value="#{msg['pat_occupation']}" />
								<p:inputText value="#{historyBacking.selected.occupation}"
									style="width:400px" label="#{msg['pat_occupation']}"
									readonly="#{historyBacking.disabledSaveButtonPatient}"
									maxlength="255" />

								<h:outputLabel value="#{msg['pat_neighborhood']}" />
								<p:inputText value="#{historyBacking.selected.neighborhood}"
									style="width:400px" label="#{msg['pat_neighborhood']}"
									readonly="#{historyBacking.disabledSaveButtonPatient}"
									maxlength="45" />

								<h:outputLabel value="#{msg['pat_type_housing']}" />
								<p:selectOneMenu value="#{historyBacking.selected.typeHousing}"
									style="width:230px" label="#{msg['pat_type_housing']}"
									disabled="#{historyBacking.disabledSaveButtonPatient}">
									<f:selectItem itemLabel="#{msg['glb_default_value']}"
										itemValue="-1" />
									<f:selectItem itemLabel="#{msg['pat_type_housing_u']}"
										itemValue="U" />
									<f:selectItem itemLabel="#{msg['pat_type_housing_r']}"
										itemValue="R" />
								</p:selectOneMenu>

							</h:panelGrid>
						</p:fieldset>

						<p:spacer height="8" />

						<p:fieldset legend="#{msg['pat_guardian_data']}">
							<h:panelGrid id="pnlDetail2" columns="4" style="margin:0 auto;"
								width="100%">

								<h:outputLabel value="#{msg['pat_guardian']}" />
								<p:inputText value="#{historyBacking.selected.guardian}"
									style="width:400px" label="#{msg['pat_guardian']}"
									readonly="#{historyBacking.disabledSaveButtonPatient}"
									maxlength="255" />

								<h:outputLabel value="#{msg['pat_guardian_address']}" />
								<p:inputText value="#{historyBacking.selected.guardianAddress}"
									style="width:400px" label="#{msg['pat_guardian_address']}"
									readonly="#{historyBacking.disabledSaveButtonPatient}"
									maxlength="255" />

								<h:outputLabel value="#{msg['pat_guardian_relationship']}" />
								<p:inputText maxlength="255"
									value="#{historyBacking.selected.guardianRelationship}"
									style="width:400px" label="#{msg['pat_guardian_relationship']}"
									readonly="#{historyBacking.disabledSaveButtonPatient}" />

								<h:outputLabel value="#{msg['pat_guardian_telephone']}" />
								<p:inputText
									value="#{historyBacking.selected.guardianTelephone}"
									style="width:400px" label="#{msg['pat_guardian_telephone']}"
									readonly="#{historyBacking.disabledSaveButtonPatient}"
									maxlength="30" />

							</h:panelGrid>
						</p:fieldset>

						<p:spacer height="8" />

						<p:fieldset legend="#{msg['pat_type_obs']}">
							<h:panelGrid id="pnlDetail3" style="margin:0 auto;" width="100%">

								<p:inputTextarea value="#{historyBacking.selected.obs}"
									maxlength="1000" style="width:100%"
									label="#{historyBacking.selected.obs}"
									readonly="#{historyBacking.disabledSaveButtonPatient}" />

							</h:panelGrid>
						</p:fieldset>
					</p:tab>

					<p:tab id="tab2" title="#{msg['his_history_history']}">

						<h:panelGrid width="100%">
							<h:outputText value="#{msg['his_history_reason']}" />
							<p:inputTextarea style="width:1100px" rows="5"
								readonly="#{historyBacking.readOnlySelectedHistoryHistory}"
								value="#{historyBacking.selectedHistoryHistory.reason}" />

							<h:outputText value="#{msg['his_history_disease']}" />
							<p:inputTextarea style="width:1100px" rows="5"
								readonly="#{historyBacking.readOnlySelectedHistoryHistory}"
								value="#{historyBacking.selectedHistoryHistory.disease}" />

							<h:outputText value="#{msg['his_history_results']}" />
							<p:inputTextarea style="width:1100px" rows="5"
								readonly="#{historyBacking.readOnlySelectedHistoryHistory}"
								value="#{historyBacking.selectedHistoryHistory.results}" />

							<p:spacer height="10" />

							<p:fieldset legend="#{msg['his_history_review']}">
								<h:panelGrid columns="2" width="100%"
									columnClasses="width25per,width25per,width25per,width25per">
									<h:outputLabel value="Cabeza" />
									<p:inputTextarea style="width:750px"
										value="#{historyBacking.selectedHistoryHistory.head}"
										readonly="#{historyBacking.readOnlySelectedHistoryHistory}" />

									<h:outputLabel value="Neuromuscular" />
									<p:inputTextarea style="width:750px"
										value="#{historyBacking.selectedHistoryHistory.neuromuscular}"
										readonly="#{historyBacking.readOnlySelectedHistoryHistory}" />

									<h:outputLabel value="ORL" />
									<p:inputTextarea style="width:750px"
										value="#{historyBacking.selectedHistoryHistory.orl}"
										readonly="#{historyBacking.readOnlySelectedHistoryHistory}" />

									<h:outputLabel value="GU" />
									<p:inputTextarea style="width:750px"
										value="#{historyBacking.selectedHistoryHistory.gu}"
										readonly="#{historyBacking.readOnlySelectedHistoryHistory}" />

									<h:outputLabel value="CR" />
									<p:inputTextarea style="width:750px"
										value="#{historyBacking.selectedHistoryHistory.cr}"
										readonly="#{historyBacking.readOnlySelectedHistoryHistory}" />

									<h:outputLabel value="Psquiatrico" />
									<p:inputTextarea style="width:750px"
										value="#{historyBacking.selectedHistoryHistory.psychiatric}"
										readonly="#{historyBacking.readOnlySelectedHistoryHistory}" />

									<h:outputLabel value="GI" />
									<p:inputTextarea style="width:750px"
										value="#{historyBacking.selectedHistoryHistory.gi}"
										readonly="#{historyBacking.readOnlySelectedHistoryHistory}" />

									<h:outputLabel value="Piel y anexos" />
									<p:inputTextarea style="width:750px"
										value="#{historyBacking.selectedHistoryHistory.skin}"
										readonly="#{historyBacking.readOnlySelectedHistoryHistory}" />
								</h:panelGrid>
							</p:fieldset>
						</h:panelGrid>

					</p:tab>

					<p:tab id="tab3" title="#{msg['his_history_record']}">
						<p:fieldset legend="Patologicos">
							<h:panelGrid columns="8" width="100%">
								<p:selectBooleanCheckbox
									value="#{historyBacking.selectedHistoryRecord.hypertension}"
									disabled="#{historyBacking.readOnlySelectedHistoryRecord}" />
								<h:outputText value="Hipertension" />

								<p:selectBooleanCheckbox
									value="#{historyBacking.selectedHistoryRecord.heart}"
									disabled="#{historyBacking.readOnlySelectedHistoryRecord}" />
								<h:outputText value="Cardiopatia" />

								<p:selectBooleanCheckbox
									value="#{historyBacking.selectedHistoryRecord.cancer}"
									disabled="#{historyBacking.readOnlySelectedHistoryRecord}" />
								<h:outputText value="Cancer" />

								<p:selectBooleanCheckbox
									value="#{historyBacking.selectedHistoryRecord.arthritis}"
									disabled="#{historyBacking.readOnlySelectedHistoryRecord}" />
								<h:outputText value="Artritis" />

								<p:selectBooleanCheckbox
									value="#{historyBacking.selectedHistoryRecord.arthritis}"
									disabled="#{historyBacking.readOnlySelectedHistoryRecord}" />
								<h:outputText value="Diabetes" />

								<h:outputText value="Tiempo DX" />
								<p:inputText
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.diabetesTime}" />

								<h:outputText value="CH GLICEMIA" />
								<p:inputText
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.diabetesGlycemia}" />

							</h:panelGrid>

							<h:panelGrid columns="2" width="100%">
								<h:outputText value="Otros Antecedentes" />
								<p:inputText
									value="#{historyBacking.selectedHistoryRecord.others}"
									style="width:900px" />
							</h:panelGrid>

						</p:fieldset>

						<p:spacer height="5" />

						<p:fieldset legend="Antecendentes">
							<h:panelGrid columns="4" width="100%">
								<h:outputText value="Quirurguicos" />
								<p:inputText style="width:350px"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.surgicalDesc}" />
								<h:outputText value="Farmacologicos" />
								<p:inputText style="width:350px"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.pharmacologicalDesc}" />
								<h:outputText value="Toxicos" />
								<p:inputText style="width:350px"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.toxicDesc}" />
								<h:outputText value="Transfusionales" />
								<p:inputText style="width:350px"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.transfusionDesc}" />
								<h:outputText value="Alergicos" />
								<p:inputText style="width:350px"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.allergyDesc}" />
								<h:outputText value="Inmunizaciones" />
								<p:inputText style="width:350px"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.immunizationsDesc}" />
								<h:outputText value="Otros" />
								<p:inputText style="width:350px"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.othersRecors}" />
							</h:panelGrid>
						</p:fieldset>


						<p:spacer height="5" />

						<p:fieldset legend="Antecendentes Familiares">
							<h:panelGrid width="100%">
								<p:inputTextarea rows="5" style="width:1100px"
									value="#{historyBacking.selectedHistoryRecord.familyHistory}"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}" />
							</h:panelGrid>
						</p:fieldset>

						<p:spacer height="4" />

						<p:fieldset legend="Gineco-Obstetricos">
							<h:panelGrid columns="10" width="100%">

								<h:outputText value="Gestacion" />
								<p:inputText
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.gestation}" />

								<h:outputText value="P" />
								<p:inputText
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.obstGynP}" />

								<h:outputText value="A" />
								<p:inputText
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.obstGynA}" />

								<h:outputText value="C" />
								<p:inputText
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.obstGynC}" />

								<h:outputText value="FUR" />
								<p:inputText
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.obstGynFur}" />
							</h:panelGrid>

							<h:panelGrid width="100%" columns="2">
								<h:outputText value="Otros" />
								<p:inputTextarea style="width:1100px" rows="3"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.obstGynOthers}" />
							</h:panelGrid>
						</p:fieldset>

					</p:tab>

					<p:tab id="tab4" title="#{msg['his_history_physique']}">
					</p:tab>

					<p:tab id="tab5" title="#{msg['his_history']}">

						<p:dataTable id="selectedTable" var="rec"
							value="#{historyBacking.appointmentModel}" rowKey="#{rec.code}"
							style="width:100%"
							selection="#{historyBacking.selectedAppointment}"
							paginator="true" rows="10"
							emptyMessage="#{msg['glb_no_records_found']}">

							<p:column headerText="#{msg['app_code']}">
								<h:outputLabel value="#{rec.code}" />
							</p:column>

							<p:column headerText="#{msg['app_date']}">
								<h:outputLabel value="#{rec.startAppointmentDate}">
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</h:outputLabel>
							</p:column>

							<p:column headerText="#{msg['app_procedure_type']}">
								<h:outputLabel value="#{rec.crmProcedureDetail.name}" />
							</p:column>

							<p:column headerText="#{msg['app_doctor']}">
								<h:outputLabel value="#{rec.crmDoctor.names}" />
							</p:column>

						</p:dataTable>

					</p:tab>

				</p:tabView>

			</h:form>

			<h:form id="editForm">
				<p:dialog header="#{msg['sal_patient']}" widgetVar="dlg2"
					resizable="false" id="dialog2" showEffect="fade"
					hideEffect="explode" modal="true" width="600">

					<h:panelGrid columns="2" width="100%">

						<p:outputPanel id="customPanel">
							<p:selectOneRadio id="customRadio"
								value="#{historyBacking.optionSearchPatient}" layout="custom">
								<f:selectItem itemLabel="#{msg['sal_key_press_doc']}"
									itemValue="1" />
								<f:selectItem itemLabel="#{msg['sal_key_press_nom']}"
									itemValue="2" />
							</p:selectOneRadio>

							<h:panelGrid columns="3" width="100%">
								<p:radioButton id="opt1" for="customRadio" itemIndex="0" />
								<h:outputLabel for="opt1" value="#{msg['sal_key_press_doc']}" />
								<p:inputText value="#{historyBacking.docPatient}"
									style="width:100%" />

								<p:radioButton id="opt2" for="customRadio" itemIndex="1" />
								<h:outputLabel for="opt2" value="#{msg['sal_key_press_nom']}" />
								<p:inputText value="#{historyBacking.namePatient}"
									style="width:100%" />

							</h:panelGrid>
						</p:outputPanel>

						<f:facet name="footer">
							<p:spacer height="10" />

							<p:commandButton value="#{msg['btn_search']}"
								icon="ui-icon-search"
								update="pnlTable2 recordTable2 btnAddPatient"
								action="#{historyBacking.searchPatientAction}" />
							<p:commandButton id="btnAddPatient" value="#{msg['btn_add']}"
								icon="ui-icon-plusthick" update=":form:pnlDetail :form:toolBar"
								oncomplete="dlg2.hide()"
								disabled="#{historyBacking.disabledAddPatient}" />
						</f:facet>
					</h:panelGrid>

					<p:spacer height="10" />
					<p:scrollPanel id="pnlTable2" style="width:580px;height:400px">
						<p:dataTable id="recordTable2" var="rec"
							value="#{historyBacking.patientModel}" rowKey="#{rec.codeSap}"
							selection="#{historyBacking.selectedPatient}" paginator="true"
							rows="15" style="width:570px"
							emptyMessage="#{msg['glb_no_records_found']}">

							<p:column selectionMode="single" style="width:18px" />

							<p:column headerText="#{msg['pat_sap_code']}">
								<h:outputLabel value="#{rec.codeSap}" />
							</p:column>

							<p:column headerText="#{msg['pat_names']}">
								<h:outputLabel value="#{rec.names}" />
							</p:column>

						</p:dataTable>
					</p:scrollPanel>

				</p:dialog>
			</h:form>

		</p:panel>

	</ui:define>
</ui:composition>
</html>
