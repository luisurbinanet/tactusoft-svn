<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">

<ui:composition template="../templates/common.xhtml">

	<ui:define name="body">

		<p:panel style="width:100%;height:100%;"
			header="#{msg['title_view_history']}">

			<p:spacer height="5" />

			<h:form id="form">

				<p:growl id="growl" showDetail="true" />

				<p:toolbar id="toolBar" style="width:100%">
					<p:toolbarGroup align="left">
						<p:commandButton id="btnNew" value="#{msg['btn_new']}"
							icon="ui-icon-document"
							actionListener="#{historyBacking.newAction}" update="form"
							process="@this" onkeypress="return false;" />
						<p:commandButton id="btnSelectPatient"
							value="#{msg['btn_add_patient']}" icon="ui-icon-circle-check"
							oncomplete="dlg2.show()" update="dialog2" />
						<p:commandButton id="btnSaveHistory"
							value="#{msg['btn_save_history']}" icon="ui-icon-disk"
							actionListener="#{historyBacking.saveAction}"
							update="toolBar growl tabView"
							disabled="#{historyBacking.disabledSaveButton}"
							rendered="#{historyBacking.rolePrincipal eq 'DOCTOR'}" />
					</p:toolbarGroup>
				</p:toolbar>

				<p:spacer height="5" />

				<h:panelGrid id="pnlPatient" columns="4" width="100%">

					<h:outputLabel value="#{msg['pat_sap_code']}"
						rendered="#{historyBacking.selectedPatient.id eq null?false:true}" />
					<p:inputText value="#{historyBacking.selectedPatient.codeSap}"
						style="width:400px;background-color:#FFFF80;font-weight:bold;"
						readonly="true"
						rendered="#{historyBacking.selectedPatient.id eq null?false:true}" />

					<h:outputLabel value="#{msg['pat_code']}"
						rendered="#{historyBacking.selectedPatient.id eq null?false:true}" />
					<p:inputText value="#{historyBacking.selectedPatient.doc}"
						style="width:400px;background-color:#FFFF80;font-weight:bold;"
						readonly="true"
						rendered="#{historyBacking.selectedPatient.id eq null?false:true}" />

					<h:outputLabel value="#{msg['pat_names']}"
						rendered="#{historyBacking.selectedPatient.id eq null?false:true}" />
					<p:inputText value="#{historyBacking.selectedPatient.names}"
						style="width:400px;background-color:#FFFF80;font-weight:bold;"
						readonly="true"
						rendered="#{historyBacking.selectedPatient.id eq null?false:true}" />

					<h:outputLabel value="#{msg['glb_gender']}"
						rendered="#{historyBacking.selectedPatient.id eq null?false:true}" />
					<p:inputText
						style="width:400px;background-color:#FFFF80;font-weight:bold;"
						readonly="true"
						rendered="#{historyBacking.selectedPatient.id eq null?false:true}"
						value="#{historyBacking.selectedPatient.gender eq 'W'?msg['glb_gender_woman']:historyBacking.selectedPatient.gender eq 'M'?msg['glb_gender_man']:''}" />

					<p:spacer height="5"
						rendered="#{historyBacking.selectedPatient.id eq null?false:true}" />
					<p:spacer height="5"
						rendered="#{historyBacking.selectedPatient.id eq null?false:true}" />

				</h:panelGrid>

				<p:tabView id="tabView" style="height:100%">

					<p:tab id="tab0" title="#{msg['his_history']}">

						<h:panelGrid columns="1" rendered="#{historyBacking.viewMode}"
							width="100%">
							<p:dataTable id="selectedTable" var="rec"
								value="#{historyBacking.appointmentModel}" rowKey="#{rec.code}"
								style="width:100%" paginator="true" rows="10"
								emptyMessage="#{msg['glb_no_records_found']}">

								<p:column headerText="#{msg['app_date']}">
									<h:outputLabel value="#{rec.startAppointmentDate}">
										<f:convertDateTime pattern="dd/MM/yyyy" />
									</h:outputLabel>
								</p:column>

								<p:column headerText="#{msg['app_branch']}">
									<h:outputLabel value="#{rec.crmBranch.name}" />
								</p:column>

								<p:column headerText="#{msg['app_doctor']}">
									<h:outputLabel value="#{rec.crmDoctor.names}" />
								</p:column>

								<p:column headerText="#{msg['app_procedure']}">
									<h:outputLabel value="#{rec.crmProcedureDetail.name}" />
								</p:column>

								<p:column style="width:4%">
									<p:commandButton update=":form:tabView"
										disabled="#{rec.closeAppointment}" icon="ui-icon-check"
										rendered="#{historyBacking.rolePrincipal eq 'DOCTOR' or historyBacking.rolePrincipal eq 'NURSE'}"
										title="#{msg['btn_edit']}">
										<f:setPropertyActionListener value="#{rec}"
											target="#{historyBacking.selectedAppointment}" />
										<f:setPropertyActionListener value="false"
											target="#{historyBacking.viewMode}" />
									</p:commandButton>
								</p:column>
							</p:dataTable>
						</h:panelGrid>

						<h:panelGrid columns="1" rendered="#{not historyBacking.viewMode}"
							width="100%">

							<p:spacer height="10" />

							<p:toolbar id="toolBar2" style="width:100%">
								<p:toolbarGroup align="left">
									<p:commandButton value="#{msg['btn_return']}"
										icon="ui-icon-arrowreturnthick-1-w" update=":form:tabView">
										<f:setPropertyActionListener value="true"
											target="#{historyBacking.viewMode}" />
									</p:commandButton>
									<p:commandButton value="#{msg['btn_close_appointment']}"
										icon="ui-icon-folder-collapsed"
										update=":form:tabView :form:growl"
										actionListener="#{historyBacking.closeAppointmentAction}" />
								</p:toolbarGroup>
							</p:toolbar>

							<p:spacer height="10" />

							<h:panelGrid id="pnlAttendedDoctor" width="100%"
								rendered="#{historyBacking.rolePrincipal eq 'DOCTOR'}">

								<p:fieldset legend="#{msg['his_history_ip']}">

									<p:dataTable id="dtbDiagnosis" var="rec"
										value="#{historyBacking.diagnosisModel}"
										selection="#{historyBacking.selectedsDiagnosis}"
										rowKey="#{rec.id}" paginator="true" rows="15"
										style="width:100%"
										emptyMessage="#{msg['glb_no_records_found']}">

										<p:column selectionMode="multiple" style="width:18px" />

										<p:column headerText="#{msg['cie_code']}">
											<h:outputLabel value="#{rec.crmCie.code}" />
										</p:column>

										<p:column headerText="#{msg['cie_desc']}">
											<h:outputLabel value="#{rec.crmCie.description}" />
										</p:column>

										<p:column style="width:8%">
											<h:panelGrid columns="2" width="100%"
												styleClass="ui-widget-content grid">
												<p:commandButton oncomplete="dlgMedicine.show()"
													update=":form:dialogMedicine" icon="ui-icon-plusthick"
													title="#{msg['btn_select_medication']}"
													action="#{historyBacking.selectMedicationAction}">
													<f:setPropertyActionListener value="#{rec}"
														target="#{historyBacking.selectedDiagnosis}" />
												</p:commandButton>
												<p:commandButton oncomplete="dlgPosology.show()"
													update=":form:dialogPosology" icon="ui-icon-comment"
													title="#{msg['btn_add_posology']}">
													<f:setPropertyActionListener value="#{rec}"
														target="#{historyBacking.selectedDiagnosis}" />
												</p:commandButton>
											</h:panelGrid>
										</p:column>

										<f:facet name="footer">
											<p:commandButton id="btnSelCie" oncomplete="dlgCie.show()"
												value="#{msg['btn_select_diagnosis']}" icon="ui-icon-search"
												actionListener="#{historyBacking.selectDiagnosisAction}"
												update=":form:dialogCie" />
											<p:commandButton oncomplete="dlgMedicationPreview.show()"
												value="#{msg['btn_view_medication']}" icon="ui-icon-search"
												disabled="#{historyBacking.disabledMedication}"
												update=":form:dialogMedicationPreview" />
											<p:commandButton value="#{msg['btn_delete']}"
												disabled="#{historyBacking.disabledDiagnosis}"
												icon="ui-icon-closethick"
												update="dtbDiagnosis :form:tabView:dtbTherapy :form:tabView:dtbExamns"
												actionListener="#{historyBacking.removeDiagnosisAction}" />
										</f:facet>

									</p:dataTable>
								</p:fieldset>

								<p:spacer />

								<p:fieldset legend="#{msg['his_history_therapy']}">

									<p:dataTable id="dtbTherapy" var="rec"
										value="#{historyBacking.therapyModel}"
										selection="#{historyBacking.selectedTherapy}"
										rowKey="#{rec.id}" paginator="true" rows="15"
										style="width:100%"
										emptyMessage="#{msg['glb_no_records_found']}">

										<p:column selectionMode="multiple" style="width:18px" />

										<p:column headerText="#{msg['sal_material_code']}">
											<h:outputLabel value="#{rec.codMaterial}" />
										</p:column>

										<p:column headerText="#{msg['sal_material_descr']}">
											<h:outputLabel value="#{rec.descMaterial}" />
										</p:column>

										<p:column headerText="#{msg['sal_material_amount']}"
											style="width:100px">
											<pe:inputNumber value="#{rec.unit}" symbolPosition="s"
												decimalPlaces="0" style="width:100px" minValue="1"
												maxValue="99" />
										</p:column>

										<f:facet name="footer">
											<p:commandButton id="btnSelTherapy"
												oncomplete="dlgMedicine.show()"
												update=":form:dialogMedicine"
												disabled="#{historyBacking.disabledDiagnosis}"
												value="#{msg['btn_select']}" icon="ui-icon-search"
												actionListener="#{historyBacking.selectTherapyAction}" />
											<p:commandButton value="#{msg['btn_delete']}"
												disabled="#{historyBacking.disabledTherapy}"
												icon="ui-icon-closethick" update="dtbTherapy"
												actionListener="#{historyBacking.removeTherapyAction}" />
										</f:facet>

									</p:dataTable>
								</p:fieldset>

								<p:spacer />

								<p:fieldset legend="#{msg['his_history_examinations']}">

									<p:dataTable id="dtbExamns" var="rec"
										value="#{historyBacking.examModel}"
										selection="#{historyBacking.selectedExam}" rowKey="#{rec.id}"
										paginator="true" rows="15" style="width:100%"
										emptyMessage="#{msg['glb_no_records_found']}">

										<p:column selectionMode="multiple" style="width:18px" />

										<p:column headerText="#{msg['sal_material_code']}">
											<h:outputLabel value="#{rec.codMaterial}" />
										</p:column>

										<p:column headerText="#{msg['sal_material_descr']}">
											<h:outputLabel value="#{rec.descMaterial}" />
										</p:column>

										<p:column headerText="#{msg['sal_material_amount']}"
											style="width:100px">
											<pe:inputNumber value="#{rec.unit}" symbolPosition="s"
												decimalPlaces="0" style="width:100px" minValue="1"
												maxValue="99" />
										</p:column>

										<f:facet name="footer">
											<p:commandButton id="btnSelExaminations"
												oncomplete="dlgMedicine.show()"
												update=":form:dialogMedicine"
												disabled="#{historyBacking.disabledDiagnosis}"
												value="#{msg['btn_select']}" icon="ui-icon-search"
												actionListener="#{historyBacking.selectExamsAction}" />
											<p:commandButton value="#{msg['btn_delete']}"
												disabled="#{historyBacking.disabledExam}"
												icon="ui-icon-closethick" update="dtbExamns"
												actionListener="#{historyBacking.removeExamAction}" />
										</f:facet>

									</p:dataTable>
								</p:fieldset>

								<p:spacer />

								<p:fieldset legend="#{msg['his_history_note']}">
									<p:inputTextarea rows="5" style="width:1100px;"
										value="#{historyBacking.noteDoctor}" />
								</p:fieldset>

							</h:panelGrid>

							<h:panelGrid id="pnlAttendedNurse" width="100%"
								rendered="#{historyBacking.rolePrincipal eq 'NURSE'}">
								<p:fieldset legend="#{msg['his_history_note']}">
									<p:inputTextarea rows="5" style="width:1100px;"
										value="#{historyBacking.noteDoctor}" />
								</p:fieldset>
							</h:panelGrid>

						</h:panelGrid>

					</p:tab>

					<p:tab id="tab1" title="#{msg['title_patient_complementary']}">
						<p:fieldset legend="#{msg['pat_personal_data']}">
							<h:panelGrid id="pnlDetail" columns="4" style="margin:0 auto;"
								width="100%">

								<h:outputLabel value="#{msg['pat_born_date']}" />
								<p:calendar value="#{historyBacking.selectedPatient.bornDate}"
									label="#{msg['pat_born_date']}" readonlyInput="true"
									pattern="dd/MM/yyyy" showOn="button" navigator="true"
									locale="es" yearRange="-100:+0"
									maxdate="#{historyBacking.maxDate}"
									readonly="#{historyBacking.readOnlySelectedHistoryHistory}">
									<p:ajax event="dateSelect"
										listener="#{historyBacking.handleBornDateSelect}"
										update="txtAge pnlGender" />
								</p:calendar>

								<h:outputLabel value="#{msg['pat_age']}" />
								<p:inputText id="txtAge"
									style="width:400px;background-color:#FFFF80;font-weight:bold;"
									readonly="true" value="#{historyBacking.age} #{msg['glb_age']}" />

								<h:outputLabel value="#{msg['pat_occupation']}" />
								<p:inputText
									style="width:400px;background-color:#FFFF80;font-weight:bold;"
									readonly="true"
									value="#{historyBacking.selectedPatient.crmOccupation.name}" />

								<h:outputLabel value="#{msg['pat_neighborhood']}" />
								<p:inputText
									style="width:400px;background-color:#FFFF80;font-weight:bold;"
									readonly="true"
									value="#{historyBacking.selectedPatient.neighborhood}" />

								<h:outputLabel value="#{msg['pat_type_housing']}" />
								<p:inputText
									style="width:400px;background-color:#FFFF80;font-weight:bold;"
									readonly="true"
									value="#{historyBacking.selectedPatient.typeHousing eq 'U'?msg['pat_type_housing_u']:historyBacking.selectedPatient.typeHousing eq 'R'?msg['pat_type_housing_r']:''}" />

							</h:panelGrid>
						</p:fieldset>

						<p:spacer height="8" />

						<p:fieldset legend="#{msg['pat_guardian_data']}">
							<h:panelGrid id="pnlDetail2" columns="4" style="margin:0 auto;"
								width="100%">

								<h:outputLabel value="#{msg['pat_guardian']}" />
								<p:inputText value="#{historyBacking.selectedPatient.guardian}"
									style="width:400px" label="#{msg['pat_guardian']}"
									readonly="#{historyBacking.readOnlySelectedHistoryHistory}"
									maxlength="255" />

								<h:outputLabel value="#{msg['pat_guardian_address']}" />
								<p:inputText
									value="#{historyBacking.selectedPatient.guardianAddress}"
									style="width:400px" label="#{msg['pat_guardian_address']}"
									readonly="#{historyBacking.readOnlySelectedHistoryHistory}"
									maxlength="255" />

								<h:outputLabel value="#{msg['pat_guardian_relationship']}" />
								<p:inputText maxlength="255"
									value="#{historyBacking.selectedPatient.guardianRelationship}"
									style="width:400px" label="#{msg['pat_guardian_relationship']}"
									readonly="#{historyBacking.readOnlySelectedHistoryHistory}" />

								<h:outputLabel value="#{msg['pat_guardian_telephone']}" />
								<p:inputText
									value="#{historyBacking.selectedPatient.guardianTelephone}"
									style="width:400px" label="#{msg['pat_guardian_telephone']}"
									readonly="#{historyBacking.readOnlySelectedHistoryHistory}"
									maxlength="30" />

							</h:panelGrid>
						</p:fieldset>
					</p:tab>

					<p:tab id="tab2" title="#{msg['his_history_history']}"
						rendered="#{historyBacking.rolePrincipal eq 'DOCTOR'}">

						<h:panelGrid width="100%">
							<h:outputText value="#{msg['his_history_reason']}" />
							<p:inputTextarea style="width:1100px" rows="5"
								readonly="#{historyBacking.readOnlySelectedHistoryHistory}"
								value="#{historyBacking.selectedHistoryHistory.reason}" />

							<h:outputText value="#{msg['his_history_disease']}" />
							<p:inputTextarea style="width:1100px" rows="5"
								readonly="#{historyBacking.readOnlySelectedHistoryHistory}"
								value="#{historyBacking.selectedHistoryHistory.disease}" />

							<h:outputText value="#{msg['his_history_results']}" />
							<p:inputTextarea style="width:1100px" rows="5"
								readonly="#{historyBacking.readOnlySelectedHistoryHistory}"
								value="#{historyBacking.selectedHistoryHistory.results}" />

							<p:spacer height="10" />

							<p:fieldset legend="#{msg['his_history_review']}">
								<h:panelGrid columns="2" width="100%"
									columnClasses="width25per,width75per">
									<h:outputLabel value="#{msg['his_history_head']}" />
									<p:inputTextarea style="width:750px"
										value="#{historyBacking.selectedHistoryHistory.head}"
										readonly="#{historyBacking.readOnlySelectedHistoryHistory}" />

									<h:outputLabel value="#{msg['his_history_orl']}" />
									<p:inputTextarea style="width:750px"
										value="#{historyBacking.selectedHistoryHistory.orl}"
										readonly="#{historyBacking.readOnlySelectedHistoryHistory}" />

									<h:outputLabel value="#{msg['his_history_cr']}" />
									<p:inputTextarea style="width:750px"
										value="#{historyBacking.selectedHistoryHistory.cr}"
										readonly="#{historyBacking.readOnlySelectedHistoryHistory}" />

									<h:outputLabel value="#{msg['his_history_gi']}" />
									<p:inputTextarea style="width:750px"
										value="#{historyBacking.selectedHistoryHistory.gi}"
										readonly="#{historyBacking.readOnlySelectedHistoryHistory}" />


									<h:outputLabel value="#{msg['his_history_neuromuscular']}" />
									<p:inputTextarea style="width:750px"
										value="#{historyBacking.selectedHistoryHistory.neuromuscular}"
										readonly="#{historyBacking.readOnlySelectedHistoryHistory}" />

									<h:outputLabel value="#{msg['his_history_gu']}" />
									<p:inputTextarea style="width:750px"
										value="#{historyBacking.selectedHistoryHistory.gu}"
										readonly="#{historyBacking.readOnlySelectedHistoryHistory}" />

									<h:outputLabel value="#{msg['his_history_psychiatric']}" />
									<p:inputTextarea style="width:750px"
										value="#{historyBacking.selectedHistoryHistory.psychiatric}"
										readonly="#{historyBacking.readOnlySelectedHistoryHistory}" />

									<h:outputLabel value="#{msg['his_history_skin']}" />
									<p:inputTextarea style="width:750px"
										value="#{historyBacking.selectedHistoryHistory.skin}"
										readonly="#{historyBacking.readOnlySelectedHistoryHistory}" />
								</h:panelGrid>
							</p:fieldset>
						</h:panelGrid>

					</p:tab>

					<p:tab id="tab3" title="#{msg['his_history_record']}"
						rendered="#{historyBacking.rolePrincipal eq 'DOCTOR'}">

						<p:fieldset legend="#{msg['his_record_personal']}">
							<h:panelGrid id="pnlPersonal" columns="3" width="100%">

								<p:selectBooleanCheckbox
									disabled="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.arthritis}"
									itemLabel="#{msg['his_rec_per_arthritis']}">
									<p:ajax update="txtPersonal1 txtPersonal2" />
								</p:selectBooleanCheckbox>

								<p:inputTextarea id="txtPersonal1" style="width:300px" rows="3"
									label="#{msg['his_record_clic_time']}"
									disabled="#{not historyBacking.selectedHistoryRecord.arthritis}"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.arthritisTime}" />

								<p:inputTextarea id="txtPersonal2" style="width:450px" rows="3"
									label="#{msg['his_record_clic_medi']}"
									disabled="#{not historyBacking.selectedHistoryRecord.arthritis}"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.arthritisMedication}" />

								<p:selectBooleanCheckbox
									disabled="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.cancer}"
									itemLabel="#{msg['his_rec_per_cancer']}">
									<p:ajax update="txtPersonal3 txtPersonal4" />
								</p:selectBooleanCheckbox>

								<p:inputTextarea id="txtPersonal3" style="width:300px" rows="3"
									disabled="#{not historyBacking.selectedHistoryRecord.cancer}"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.cancerTime}" />

								<p:inputTextarea id="txtPersonal4" style="width:450px" rows="3"
									disabled="#{not historyBacking.selectedHistoryRecord.cancer}"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.cancerMedication}" />

								<p:selectBooleanCheckbox
									disabled="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.pulmonary}"
									itemLabel="#{msg['his_rec_per_pulmonary']}">
									<p:ajax update="txtPersonal5 txtPersonal6" />
								</p:selectBooleanCheckbox>

								<p:inputTextarea id="txtPersonal5" style="width:300px" rows="3"
									disabled="#{not historyBacking.selectedHistoryRecord.pulmonary}"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.pulmonaryTime}" />

								<p:inputTextarea id="txtPersonal6" style="width:450px" rows="3"
									disabled="#{not historyBacking.selectedHistoryRecord.pulmonary}"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.pulmonaryMedication}" />

								<p:selectBooleanCheckbox
									disabled="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.diabetes}"
									itemLabel="#{msg['his_rec_per_diabetes']}">
									<p:ajax update="txtPersonal7 txtPersonal8" />
								</p:selectBooleanCheckbox>

								<p:inputTextarea id="txtPersonal7" style="width:300px" rows="3"
									disabled="#{not historyBacking.selectedHistoryRecord.diabetes}"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.diabetesTime}" />

								<p:inputTextarea id="txtPersonal8" style="width:450px" rows="3"
									disabled="#{not historyBacking.selectedHistoryRecord.diabetes}"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.diabetesMedication}" />

								<p:selectBooleanCheckbox
									disabled="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.hypertension}"
									itemLabel="#{msg['his_rec_per_hypertension']}">
									<p:ajax update="txtPersonal9 txtPersonal10" />
								</p:selectBooleanCheckbox>

								<p:inputTextarea id="txtPersonal9" style="width:300px" rows="3"
									disabled="#{not historyBacking.selectedHistoryRecord.hypertension}"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.hypertensionTime}" />

								<p:inputTextarea id="txtPersonal10" style="width:450px" rows="3"
									disabled="#{not historyBacking.selectedHistoryRecord.hypertension}"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.hypertensionMedication}" />

								<p:selectBooleanCheckbox
									disabled="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.hospitalizations}"
									itemLabel="#{msg['his_rec_per_hospitalizations']}">
									<p:ajax update="txtPersonal11 txtPersonal12" />
								</p:selectBooleanCheckbox>

								<p:inputTextarea id="txtPersonal11" style="width:300px" rows="3"
									disabled="#{not historyBacking.selectedHistoryRecord.hospitalizations}"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.hospitalizationsTime}" />

								<p:inputTextarea id="txtPersonal12" style="width:450px" rows="3"
									disabled="#{not historyBacking.selectedHistoryRecord.hospitalizations}"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.hospitalizationsMedication}" />

								<p:selectBooleanCheckbox
									disabled="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.allergy}"
									itemLabel="#{msg['his_rec_per_allergy']}">
									<p:ajax update="txtPersonal13 txtPersonal14" />
								</p:selectBooleanCheckbox>

								<p:inputTextarea id="txtPersonal13" style="width:300px" rows="3"
									disabled="#{not historyBacking.selectedHistoryRecord.allergy}"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.allergyTime}" />

								<p:inputTextarea id="txtPersonal14" style="width:450px" rows="3"
									disabled="#{not historyBacking.selectedHistoryRecord.allergy}"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.allergyMedication}" />

								<p:selectBooleanCheckbox
									disabled="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.infections}"
									itemLabel="#{msg['his_rec_per_infections']}">
									<p:ajax update="txtPersonal15 txtPersonal16" />
								</p:selectBooleanCheckbox>

								<p:inputTextarea id="txtPersonal15" style="width:300px" rows="3"
									disabled="#{not historyBacking.selectedHistoryRecord.infections}"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.infectionsTime}" />

								<p:inputTextarea id="txtPersonal16" style="width:450px" rows="3"
									disabled="#{not historyBacking.selectedHistoryRecord.infections}"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.infectionsMedication}" />

							</h:panelGrid>

							<p:spacer height="5" />

							<h:panelGrid columns="2" width="100%"
								columnClasses="width25per,width75per">
								<h:outputText value="#{msg['his_rec_per_occupational']}" />
								<p:inputTextarea style="width:950px" rows="3"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.occupational}" />

								<h:outputText value="#{msg['his_rec_per_toxic']}" />
								<p:inputTextarea style="width:950px" rows="3"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.toxic}" />

								<h:outputText value="#{msg['his_rec_blood_type']}" />
								<p:inputTextarea style="width:950px" rows="3"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.bloodType}" />
							</h:panelGrid>
						</p:fieldset>

						<h:panelGrid id="pnlGender" width="100%">

							<p:spacer height="5"
								rendered="#{historyBacking.renderedRecord eq 2?true:false}" />

							<p:fieldset legend="#{msg['his_record_men']}"
								rendered="#{historyBacking.renderedRecord eq 3?true:false}">
								<h:panelGrid columns="2" width="100%"
									columnClasses="width25per,width75per">

									<h:outputLabel value="#{msg['his_rec_fuep']}" />
									<p:calendar
										readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
										value="#{historyBacking.selectedHistoryRecord.fuep}"
										readonlyInput="true" pattern="dd/MM/yyyy" showOn="button"
										navigator="true" locale="es" yearRange="-100:+0" />

									<h:outputText value="#{msg['his_rec_psa']}" />
									<p:inputText
										readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
										value="#{historyBacking.selectedHistoryRecord.psa}" />

									<h:outputLabel value="#{msg['his_rec_psa_date']}" />
									<p:calendar
										readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
										value="#{historyBacking.selectedHistoryRecord.psaDate}"
										readonlyInput="true" pattern="dd/MM/yyyy" showOn="button"
										navigator="true" locale="es" yearRange="-100:+0" />
								</h:panelGrid>
							</p:fieldset>

							<p:spacer height="5"
								rendered="#{historyBacking.renderedRecord eq 2?true:false}" />

							<p:fieldset legend="#{msg['his_record_women']}"
								rendered="#{historyBacking.renderedRecord eq 2?true:false}">
								<h:panelGrid columns="4" width="100%"
									columnClasses="width25per,width75per">

									<h:outputText value="#{msg['his_rec_pregnancy']}" />
									<p:inputText style="width:350px"
										readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
										value="#{historyBacking.selectedHistoryRecord.pregnancy}" />

									<h:outputText value="#{msg['his_rec_parity']}" />
									<p:inputText style="width:350px"
										readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
										value="#{historyBacking.selectedHistoryRecord.parity}" />

									<h:outputText value="#{msg['his_rec_abortions']}" />
									<p:inputText style="width:350px"
										readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
										value="#{historyBacking.selectedHistoryRecord.abortions}" />

									<h:outputText value="#{msg['his_rec_caesarean']}" />
									<p:inputText style="width:350px"
										readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
										value="#{historyBacking.selectedHistoryRecord.caesarean}" />

									<h:outputText value="#{msg['his_rec_stillbirths']}" />
									<p:inputText style="width:350px"
										readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
										value="#{historyBacking.selectedHistoryRecord.stillbirths}" />

									<h:outputLabel />
									<h:outputLabel />

									<h:outputText value="#{msg['his_rec_menarche']}" />
									<p:inputText style="width:350px"
										readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
										value="#{historyBacking.selectedHistoryRecord.menarche}" />

									<h:outputText value="#{msg['his_rec_sexarca']}" />
									<p:inputText style="width:350px"
										readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
										value="#{historyBacking.selectedHistoryRecord.sexarca}" />

									<h:outputLabel value="#{msg['his_rec_fur']}" />
									<p:calendar
										readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
										value="#{historyBacking.selectedHistoryRecord.fur}"
										readonlyInput="true" pattern="dd/MM/yyyy" showOn="button"
										navigator="true" locale="es" yearRange="-100:+0" />

									<h:outputText value="#{msg['his_rec_bleeding']}" />
									<p:inputText style="width:350px"
										readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
										value="#{historyBacking.selectedHistoryRecord.bleeding}" />

									<h:outputLabel value="#{msg['his_rec_fuc']}" />
									<p:calendar
										readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
										value="#{historyBacking.selectedHistoryRecord.fuc}"
										readonlyInput="true" pattern="dd/MM/yyyy" showOn="button"
										navigator="true" locale="es" yearRange="-100:+0" />

								</h:panelGrid>
							</p:fieldset>

							<p:spacer height="5"
								rendered="#{historyBacking.renderedRecord eq 1?true:false}" />

							<p:fieldset legend="#{msg['his_record_children']}"
								rendered="#{historyBacking.renderedRecord eq 1?true:false}">
								<h:panelGrid columns="2" width="100%"
									columnClasses="width25per,width75per">

									<h:outputText value="#{msg['his_rec_neonatal']}" />
									<p:inputTextarea style="width:950px" rows="3"
										readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
										value="#{historyBacking.selectedHistoryRecord.neonatal}" />

									<h:outputText value="#{msg['his_rec_perinatal']}" />
									<p:inputTextarea style="width:950px" rows="3"
										readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
										value="#{historyBacking.selectedHistoryRecord.perinatal}" />

									<h:outputText value="#{msg['his_rec_vaccination']}" />
									<p:inputTextarea style="width:950px" rows="3"
										readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
										value="#{historyBacking.selectedHistoryRecord.vaccination}" />

									<h:outputText value="#{msg['his_rec_growth']}" />
									<p:inputTextarea style="width:950px" rows="3"
										readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
										value="#{historyBacking.selectedHistoryRecord.growth}" />

								</h:panelGrid>
							</p:fieldset>
						</h:panelGrid>

						<p:spacer height="5" />

						<p:fieldset legend="#{msg['his_record_family']}">
							<h:panelGrid columns="2" width="100%"
								columnClasses="width25per,width75per">

								<h:outputText value="#{msg['his_rec_per_hypertension']}" />
								<p:inputTextarea style="width:950px" rows="3"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.hypertensionParent}" />

								<h:outputText value="#{msg['his_rec_epoc']}" />
								<p:inputTextarea style="width:950px" rows="3"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.epocParent}" />

								<h:outputText value="#{msg['his_rec_heart_disease']}" />
								<p:inputTextarea style="width:950px" rows="3"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.heartDiseaseParent}" />

								<h:outputText value="#{msg['his_rec_asthma']}" />
								<p:inputTextarea style="width:950px" rows="3"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.asthmaParent}" />

								<h:outputText value="#{msg['his_rec_acv']}" />
								<p:inputTextarea style="width:950px" rows="3"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.acvParent}" />

								<h:outputText value="#{msg['his_rec_per_cancer']}" />
								<p:inputTextarea style="width:950px" rows="3"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.cancerParent}" />

								<h:outputText value="#{msg['his_rec_per_diabetes']}" />
								<p:inputTextarea style="width:950px" rows="3"
									readonly="#{historyBacking.readOnlySelectedHistoryRecord}"
									value="#{historyBacking.selectedHistoryRecord.diabetesParent}" />
							</h:panelGrid>
						</p:fieldset>

					</p:tab>

					<p:tab id="tab4" title="#{msg['his_history_homeopathic']}"
						rendered="#{historyBacking.rolePrincipal eq 'DOCTOR'}">

						<p:fieldset legend="#{msg['his_homeopathic_biotipology']}">
							<h:panelGrid width="100%">
								<p:selectOneRadio id="options" layout="pageDirection"
									disabled="#{historyBacking.readOnlySelectedHistoryHomeopathic}"
									value="#{historyBacking.selectedHistoryHomeopathic.biotypology}">
									<f:selectItem
										itemLabel="#{msg['his_homeopathic_biotipology_1']}"
										itemValue="C" />
									<f:selectItem
										itemLabel="#{msg['his_homeopathic_biotipology_2']}"
										itemValue="S" />
									<f:selectItem
										itemLabel="#{msg['his_homeopathic_biotipology_3']}"
										itemValue="F" />
									<f:selectItem
										itemLabel="#{msg['his_homeopathic_biotipology_4']}"
										itemValue="U" />
								</p:selectOneRadio>
							</h:panelGrid>
						</p:fieldset>

						<p:spacer height="5" />

						<h:panelGrid columns="2" width="100%"
							columnClasses="width25per,width75per">

							<h:outputLabel value="#{msg['his_homeopathic_mental']}" />
							<p:inputTextarea style="width:750px"
								value="#{historyBacking.selectedHistoryHomeopathic.mental}"
								readonly="#{historyBacking.readOnlySelectedHistoryHomeopathic}" />

							<h:outputLabel value="#{msg['his_homeopathic_special']}" />
							<p:inputTextarea style="width:750px"
								value="#{historyBacking.selectedHistoryHomeopathic.special}"
								readonly="#{historyBacking.readOnlySelectedHistoryHomeopathic}" />

							<h:outputLabel value="#{msg['his_homeopathic_general']}" />
							<p:inputTextarea style="width:750px"
								value="#{historyBacking.selectedHistoryHomeopathic.general}"
								readonly="#{historyBacking.readOnlySelectedHistoryHomeopathic}" />

							<h:outputLabel value="#{msg['his_homeopathic_miasm']}" />
							<p:inputTextarea style="width:750px"
								value="#{historyBacking.selectedHistoryHomeopathic.miasm}"
								readonly="#{historyBacking.readOnlySelectedHistoryHomeopathic}" />

						</h:panelGrid>

					</p:tab>

					<p:tab id="tab5" title="#{msg['his_history_physique']}"
						rendered="#{historyBacking.rolePrincipal eq 'DOCTOR'}">
						<h:panelGrid columns="4" width="100%"
							columnClasses="width25per,width25per,width25per,width25per">

							<h:outputLabel value="#{msg['his_physique_heart_rate']}" />
							<pe:inputNumber symbol="   puls" symbolPosition="s"
								decimalPlaces="0" style="width:300px" maxValue="200"
								value="#{historyBacking.selectedHistoryPhysique.heartRate}"
								readonly="#{historyBacking.readOnlySelectedHistoryPhysique}" />

							<h:outputLabel value="#{msg['his_physique_respiratory_rate']}" />
							<pe:inputNumber symbol="   resp/min" symbolPosition="s"
								decimalPlaces="0" style="width:300px" maxValue="70"
								value="#{historyBacking.selectedHistoryPhysique.respiratoryRate}"
								readonly="#{historyBacking.readOnlySelectedHistoryPhysique}" />

							<h:outputLabel value="#{msg['his_physique_height']}" />
							<pe:inputNumber symbol="   cm" symbolPosition="s"
								decimalPlaces="0" style="width:300px" maxValue="250"
								value="#{historyBacking.selectedHistoryPhysique.height}"
								readonly="#{historyBacking.readOnlySelectedHistoryPhysique}" />

							<h:outputLabel value="#{msg['his_physique_weight']}" />
							<pe:inputNumber symbol="   kg" symbolPosition="s"
								decimalPlaces="2" style="width:300px" maxValue="999"
								value="#{historyBacking.selectedHistoryPhysique.weight}"
								readonly="#{historyBacking.readOnlySelectedHistoryPhysique}" />

							<h:outputLabel value="#{msg['his_physique_blood_pressure']}" />
							<p:inputText maxlength="7" style="width:300px"
								value="#{historyBacking.selectedHistoryPhysique.bloodPressure}"
								readonly="#{historyBacking.readOnlySelectedHistoryPhysique}" />
						</h:panelGrid>

						<h:panelGrid id="pnlIMC" columns="4" width="100%"
							columnClasses="width25per,width25per,width25per,width25per">

							<h:outputLabel value="#{msg['his_physique_imc']}" />
							<pe:inputNumber symbol="  Kg/m2" symbolPosition="s"
								decimalPlaces="2" style="width:300px" maxValue="999"
								value="#{historyBacking.imc}" readonly="true" />

							<h:outputLabel value="#{msg['his_physique_imc']}" />
							<p:inputText value="#{historyBacking.descImc}"
								style="width:300px" />

							<p:commandButton action="#{historyBacking.calculateIMC}"
								rendered="#{not historyBacking.readOnlySelectedHistoryPhysique}"
								update="pnlIMC" value="#{msg['btn_calculate_imc']}" />

						</h:panelGrid>

						<h:panelGrid id="pnlPhysique" columns="2" width="100%"
							columnClasses="width25per,width75per">

							<p:selectBooleanCheckbox
								disabled="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.generalStateCheck}"
								itemLabel="#{msg['his_physique_general_state']}">
								<p:ajax update="txtPersonal17" />
							</p:selectBooleanCheckbox>
							<p:inputTextarea id="txtPersonal17" style="width:950px" rows="3"
								disabled="#{not historyBacking.selectedHistoryPhysique.generalStateCheck}"
								readonly="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.generalState}" />

							<p:selectBooleanCheckbox
								disabled="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.headNeckCheck}"
								itemLabel="#{msg['his_physique_head_neck']}">
								<p:ajax update="txtPersonal18" />
							</p:selectBooleanCheckbox>
							<p:inputTextarea id="txtPersonal18" style="width:950px" rows="3"
								disabled="#{not historyBacking.selectedHistoryPhysique.headNeckCheck}"
								readonly="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.headNeck}" />

							<p:selectBooleanCheckbox
								disabled="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.chestCheck}"
								itemLabel="#{msg['his_physique_chest']}">
								<p:ajax update="txtPersonal19" />
							</p:selectBooleanCheckbox>
							<p:inputTextarea id="txtPersonal19" style="width:950px" rows="3"
								disabled="#{not historyBacking.selectedHistoryPhysique.chestCheck}"
								readonly="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.chest}" />

							<p:selectBooleanCheckbox
								disabled="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.lungsCheck}"
								itemLabel="#{msg['his_physique_lungs']}">
								<p:ajax update="txtPersonal20" />
							</p:selectBooleanCheckbox>
							<p:inputTextarea id="txtPersonal20" style="width:950px" rows="3"
								disabled="#{not historyBacking.selectedHistoryPhysique.lungsCheck}"
								readonly="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.lungs}" />

							<p:selectBooleanCheckbox
								disabled="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.heartCheck}"
								itemLabel="#{msg['his_physique_heart']}">
								<p:ajax update="txtPersonal21" />
							</p:selectBooleanCheckbox>
							<p:inputTextarea id="txtPersonal21" style="width:950px" rows="3"
								disabled="#{not historyBacking.selectedHistoryPhysique.heartCheck}"
								readonly="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.heart}" />

							<p:selectBooleanCheckbox
								disabled="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.abdomenCheck}"
								itemLabel="#{msg['his_physique_abdomen']}">
								<p:ajax update="txtPersonal22" />
							</p:selectBooleanCheckbox>
							<p:inputTextarea id="txtPersonal22" style="width:950px" rows="3"
								disabled="#{not historyBacking.selectedHistoryPhysique.abdomenCheck}"
								readonly="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.abdomen}" />

							<p:selectBooleanCheckbox
								disabled="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.genitalsCheck}"
								itemLabel="#{msg['his_physique_genitals']}">
								<p:ajax update="txtPersonal23" />
							</p:selectBooleanCheckbox>
							<p:inputTextarea id="txtPersonal23" style="width:950px" rows="3"
								disabled="#{not historyBacking.selectedHistoryPhysique.genitalsCheck}"
								readonly="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.genitals}" />

							<p:selectBooleanCheckbox
								disabled="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.osteoCheck}"
								itemLabel="#{msg['his_physique_osteo']}">
								<p:ajax update="txtPersonal24" />
							</p:selectBooleanCheckbox>
							<p:inputTextarea id="txtPersonal24" style="width:950px" rows="3"
								disabled="#{not historyBacking.selectedHistoryPhysique.osteoCheck}"
								readonly="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.osteo}" />

							<p:selectBooleanCheckbox
								disabled="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.tipsCheck}"
								itemLabel="#{msg['his_physique_tips']}">
								<p:ajax update="txtPersonal25" />
							</p:selectBooleanCheckbox>
							<p:inputTextarea id="txtPersonal25" style="width:950px" rows="3"
								disabled="#{not historyBacking.selectedHistoryPhysique.tipsCheck}"
								readonly="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.tips}" />

							<p:selectBooleanCheckbox
								disabled="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.highlightsCheck}"
								itemLabel="#{msg['his_physique_highlights']}">
								<p:ajax update="txtPersonal26" />
							</p:selectBooleanCheckbox>
							<p:inputTextarea id="txtPersonal26" style="width:950px" rows="3"
								disabled="#{not historyBacking.selectedHistoryPhysique.highlightsCheck}"
								readonly="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.highlights}" />

							<p:selectBooleanCheckbox
								disabled="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.skinCheck}"
								itemLabel="#{msg['his_physique_skin']}">
								<p:ajax update="txtPersonal27" />
							</p:selectBooleanCheckbox>
							<p:inputTextarea id="txtPersonal27" style="width:950px" rows="3"
								disabled="#{not historyBacking.selectedHistoryPhysique.skinCheck}"
								readonly="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.skin}" />

							<h:outputLabel value="#{msg['his_history_obs']}" />
							<p:inputTextarea id="txtPersonal28" style="width:950px" rows="3"
								disabled="#{historyBacking.readOnlySelectedHistoryPhysique}"
								readonly="#{historyBacking.readOnlySelectedHistoryPhysique}"
								value="#{historyBacking.selectedHistoryPhysique.obs}" />
						</h:panelGrid>
					</p:tab>

					<p:tab id="tab6" title="#{msg['his_organometry']}"
						rendered="#{historyBacking.rolePrincipal eq 'DOCTOR'}">
						<h:panelGrid id="pnlOrganometry" columns="1" width="100%">
							<p:selectBooleanCheckbox
								disabled="#{historyBacking.readOnlySelectedHistoryOrganometry}"
								value="#{historyBacking.selectedHistoryOrganometry.organometryCheck}"
								itemLabel="#{msg['his_organometry_check']}">
								<p:ajax update="pnlOrganometry" />
							</p:selectBooleanCheckbox>
							<h:outputLabel value="#{msg['his_organometry_analysis']}" />
							<p:inputTextarea style="width:950px" rows="3"
								disabled="#{not historyBacking.selectedHistoryOrganometry.organometryCheck}"
								readonly="#{historyBacking.readOnlySelectedHistoryOrganometry}"
								value="#{historyBacking.selectedHistoryOrganometry.organometryAnalysis}" />
						</h:panelGrid>
					</p:tab>

					<p:tab id="tab7" title="#{msg['his_history_ip']}"
						rendered="#{historyBacking.rolePrincipal eq 'DOCTOR'}">
						<p:dataTable var="rec" value="#{historyBacking.listDiagnosisView}"
							paginator="true" rows="15" style="width:100%"
							emptyMessage="#{msg['glb_no_records_found']}">

							<p:column headerText="#{msg['app_date']}">
								<h:outputLabel
									value="#{rec.crmAppointment.startAppointmentDate}">
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</h:outputLabel>
							</p:column>

							<p:column headerText="#{msg['app_doctor']}">
								<h:outputLabel value="#{rec.crmAppointment.crmDoctor.names}" />
							</p:column>

							<p:column headerText="#{msg['cie_desc']}">
								<h:outputLabel value="#{rec.crmCie.description}" />
							</p:column>

						</p:dataTable>

					</p:tab>

					<p:tab id="tab8" title="#{msg['his_history_medicaction']}"
						rendered="#{historyBacking.rolePrincipal eq 'DOCTOR'}">
						<p:dataTable var="rec"
							value="#{historyBacking.listMedicationView}" paginator="true"
							rows="15" style="width:100%"
							emptyMessage="#{msg['glb_no_records_found']}">

							<p:column headerText="#{msg['app_date']}">
								<h:outputLabel
									value="#{rec.crmAppointment.startAppointmentDate}">
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</h:outputLabel>
							</p:column>

							<p:column headerText="#{msg['app_doctor']}">
								<h:outputLabel value="#{rec.crmAppointment.crmDoctor.names}" />
							</p:column>

							<p:column headerText="#{msg['sal_material_descr']}">
								<h:outputLabel value="#{rec.descMaterial}" />
							</p:column>

							<p:column headerText="#{msg['sal_material_amount']}"
								style="width:100px">
								<h:outputLabel value="#{rec.unit}" />
							</p:column>
						</p:dataTable>
					</p:tab>

					<p:tab id="tab9" title="#{msg['his_history_therapy']}">
						<p:dataTable var="rec" value="#{historyBacking.listTherapyView}"
							paginator="true" rows="15" style="width:100%"
							emptyMessage="#{msg['glb_no_records_found']}">

							<p:column headerText="#{msg['app_date']}">
								<h:outputLabel
									value="#{rec.crmAppointment.startAppointmentDate}">
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</h:outputLabel>
							</p:column>

							<p:column headerText="#{msg['app_doctor']}">
								<h:outputLabel value="#{rec.crmAppointment.crmDoctor.names}" />
							</p:column>

							<p:column headerText="#{msg['sal_material_descr']}">
								<h:outputLabel value="#{rec.descMaterial}" />
							</p:column>

							<p:column headerText="#{msg['sal_material_amount']}"
								style="width:100px">
								<h:outputLabel value="#{rec.unit}" />
							</p:column>
						</p:dataTable>
					</p:tab>

					<p:tab id="tab10" title="#{msg['his_history_examinations']}"
						rendered="#{historyBacking.rolePrincipal eq 'DOCTOR'}">
						<p:dataTable var="rec" value="#{historyBacking.listExamView}"
							paginator="true" rows="15" style="width:100%"
							emptyMessage="#{msg['glb_no_records_found']}">

							<p:column headerText="#{msg['app_date']}">
								<h:outputLabel
									value="#{rec.crmAppointment.startAppointmentDate}">
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</h:outputLabel>
							</p:column>

							<p:column headerText="#{msg['app_doctor']}">
								<h:outputLabel value="#{rec.crmAppointment.crmDoctor.names}" />
							</p:column>

							<p:column headerText="#{msg['sal_material_descr']}">
								<h:outputLabel value="#{rec.descMaterial}" />
							</p:column>

							<p:column headerText="#{msg['sal_material_amount']}"
								style="width:100px">
								<h:outputLabel value="#{rec.unit}" />
							</p:column>
						</p:dataTable>
					</p:tab>

					<p:tab id="tab11" title="#{msg['his_history_note']}">
						<p:dataTable var="rec" value="#{historyBacking.listNoteView}"
							paginator="true" rows="15" style="width:100%"
							emptyMessage="#{msg['glb_no_records_found']}">

							<p:column headerText="#{msg['app_date']}">
								<h:outputLabel
									value="#{rec.crmAppointment.startAppointmentDate}">
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</h:outputLabel>
							</p:column>

							<p:column headerText="#{msg['app_doctor']}">
								<h:outputLabel value="#{rec.crmAppointment.crmDoctor.names}" />
							</p:column>

							<p:column headerText="#{msg['his_history_note_type']}">
								<h:outputLabel value="#{rec.noteType}" />
							</p:column>

							<p:column headerText="#{msg['his_history_note']}"
								style="width:600px">
								<h:outputLabel value="#{rec.note}" />
							</p:column>
						</p:dataTable>
					</p:tab>
				</p:tabView>


				<p:dialog header="#{msg['sal_patient']}" widgetVar="dlg2"
					resizable="false" id="dialog2" showEffect="fade"
					hideEffect="explode" modal="true" width="600">

					<h:panelGrid columns="2" width="100%">

						<p:outputPanel id="customPanel">
							<p:selectOneRadio id="customRadio"
								value="#{historyBacking.optionSearchPatient}" layout="custom">
								<f:selectItem itemLabel="#{msg['sal_key_press_doc']}"
									itemValue="1" />
								<f:selectItem itemLabel="#{msg['sal_key_press_nom']}"
									itemValue="2" />
							</p:selectOneRadio>

							<h:panelGrid columns="3" width="100%">
								<p:radioButton id="opt1" for="customRadio" itemIndex="0" />
								<h:outputLabel for="opt1" value="#{msg['sal_key_press_doc']}" />
								<p:inputText value="#{historyBacking.docPatient}"
									style="width:100%" />

								<p:radioButton id="opt2" for="customRadio" itemIndex="1" />
								<h:outputLabel for="opt2" value="#{msg['sal_key_press_nom']}" />
								<p:inputText value="#{historyBacking.namePatient}"
									style="width:100%" />

							</h:panelGrid>
						</p:outputPanel>

						<f:facet name="footer">
							<p:spacer height="10" />

							<p:commandButton value="#{msg['btn_search']}"
								icon="ui-icon-search"
								update="pnlTable2 recordTable2 btnAddPatient"
								action="#{historyBacking.searchPatientAction}" />
							<p:commandButton id="btnAddPatient" value="#{msg['btn_add']}"
								icon="ui-icon-plusthick" update="pnlPatient toolBar tabView"
								actionListener="#{historyBacking.searchAction}"
								disabled="#{historyBacking.disabledAddPatient}"
								oncomplete="dlg2.hide()" />
						</f:facet>
					</h:panelGrid>

					<p:spacer height="10" />

					<p:scrollPanel id="pnlTable2" style="width:580px;height:400px">
						<p:dataTable id="recordTable2" var="rec"
							value="#{historyBacking.patientModel}" rowKey="#{rec.codeSap}"
							selection="#{historyBacking.selectedPatient}" paginator="true"
							rows="15" style="width:570px"
							emptyMessage="#{msg['glb_no_records_found']}">

							<p:column selectionMode="single" style="width:18px" />

							<p:column headerText="#{msg['pat_sap_code']}">
								<h:outputLabel value="#{rec.codeSap}" />
							</p:column>

							<p:column headerText="#{msg['pat_names']}">
								<h:outputLabel value="#{rec.names}" />
							</p:column>

						</p:dataTable>
					</p:scrollPanel>

				</p:dialog>

				<p:dialog header="#{msg['his_history_ip']}" widgetVar="dlgCie"
					resizable="false" id="dialogCie" showEffect="fade"
					hideEffect="explode" modal="true" width="600">

					<h:panelGrid columns="2" width="100%">

						<p:outputPanel>
							<p:selectOneRadio id="sorCIE"
								value="#{historyBacking.optionSearchCie}" layout="custom">
								<f:selectItem itemLabel="#{msg['cie_code']}" itemValue="1" />
								<f:selectItem itemLabel="#{msg['cie_desc']}" itemValue="2" />
							</p:selectOneRadio>

							<h:panelGrid columns="3" width="100%">
								<p:radioButton id="rdbCIE1" for="sorCIE" itemIndex="0" />
								<h:outputLabel for="rdbCIE1" value="#{msg['cie_code']}" />
								<p:inputText value="#{historyBacking.codeCIE}"
									style="width:100%" />

								<p:radioButton id="rdbCIE2" for="sorCIE" itemIndex="1" />
								<h:outputLabel for="rdbCIE2" value="#{msg['cie_desc']}" />
								<p:inputText value="#{historyBacking.descCIE}"
									style="width:100%" />
							</h:panelGrid>
						</p:outputPanel>

						<f:facet name="footer">
							<p:spacer height="10" />

							<p:commandButton value="#{msg['btn_search']}"
								icon="ui-icon-search" update="pnlTable3 recordTable3 btnAddCIE"
								actionListener="#{historyBacking.searchCIEAction}" />
							<p:commandButton id="btnAddCIE" value="#{msg['btn_add']}"
								icon="ui-icon-plusthick"
								update="recordTable3 :form:tabView:dtbDiagnosis :form:tabView:dtbTherapy :form:tabView:dtbExamns"
								actionListener="#{historyBacking.addCieAction}"
								disabled="#{historyBacking.disabledAddCie}" />
						</f:facet>
					</h:panelGrid>

					<p:spacer height="10" />

					<p:scrollPanel id="pnlTable3" style="width:580px;height:400px">
						<p:dataTable id="recordTable3" var="rec"
							value="#{historyBacking.cieModel}" rowKey="#{rec.id}"
							selection="#{historyBacking.selectedCie}" paginator="true"
							rows="15" style="width:570px"
							emptyMessage="#{msg['glb_no_records_found']}">

							<p:column selectionMode="single" style="width:18px" />

							<p:column headerText="#{msg['cie_code']}">
								<h:outputLabel value="#{rec.code}" />
							</p:column>

							<p:column headerText="#{msg['cie_desc']}">
								<h:outputLabel value="#{rec.description}" />
							</p:column>

						</p:dataTable>
					</p:scrollPanel>

				</p:dialog>

				<p:dialog header="#{historyBacking.titleMedication}"
					widgetVar="dlgMedicine" resizable="false" id="dialogMedicine"
					showEffect="fade" hideEffect="explode" modal="true" width="600">

					<h:panelGrid columns="2" width="100%">

						<p:outputPanel>
							<p:selectOneRadio id="sorMedicine"
								value="#{historyBacking.optionSearchMaterial}" layout="custom">
								<f:selectItem itemLabel="#{msg['cie_code']}" itemValue="1" />
								<f:selectItem itemLabel="#{msg['cie_desc']}" itemValue="2" />
							</p:selectOneRadio>

							<h:panelGrid columns="3" width="100%">
								<p:radioButton id="rdbMedicine1" for="sorMedicine" itemIndex="0" />
								<h:outputLabel for="rdbMedicine1" value="#{msg['cie_code']}" />
								<p:inputText value="#{historyBacking.codeMaterial}"
									style="width:100%" />

								<p:radioButton id="rdbMedicine2" for="sorMedicine" itemIndex="1" />
								<h:outputLabel for="rdbMedicine2" value="#{msg['cie_desc']}" />
								<p:inputText value="#{historyBacking.descMaterial}"
									style="width:100%" />

								<h:outputLabel />
								<h:outputLabel value="#{msg['sal_material_amount']}" />
								<pe:inputNumber value="#{historyBacking.amount}" minValue="1"
									maxValue="99" />
							</h:panelGrid>
						</p:outputPanel>

						<f:facet name="footer">
							<p:spacer height="10" />

							<p:commandButton value="#{msg['btn_search']}"
								icon="ui-icon-search"
								update="pnlTable4 recordTable4 btnAddMaterial"
								actionListener="#{historyBacking.searchMaterialAction}" />
							<p:commandButton id="btnAddMaterial" value="#{msg['btn_add']}"
								icon="ui-icon-plusthick"
								update="recordTable4 :form:tabView:dtbDiagnosis :form:tabView:dtbTherapy :form:tabView:dtbExamns"
								actionListener="#{historyBacking.addMaterialAction}"
								disabled="#{historyBacking.disabledAddMaterial}" />
						</f:facet>
					</h:panelGrid>

					<p:spacer height="10" />

					<p:scrollPanel id="pnlTable4" style="width:580px;height:400px">
						<p:dataTable id="recordTable4" var="rec"
							value="#{historyBacking.materialModel}" rowKey="#{rec.code}"
							selection="#{historyBacking.selectedMaterial}" paginator="true"
							rows="15" style="width:570px"
							emptyMessage="#{msg['glb_no_records_found']}">

							<p:column selectionMode="single" style="width:18px" />

							<p:column headerText="#{msg['cie_code']}">
								<h:outputLabel value="#{rec.code}" />
							</p:column>

							<p:column headerText="#{msg['cie_desc']}">
								<h:outputLabel value="#{rec.names}" />
							</p:column>

						</p:dataTable>
					</p:scrollPanel>

				</p:dialog>

				<p:dialog header="#{msg['btn_add_posology']}"
					widgetVar="dlgPosology" resizable="false" id="dialogPosology"
					showEffect="fade" hideEffect="explode" modal="true" width="600">

					<p:inputTextarea rows="7" style="width:560px"
						value="#{historyBacking.selectedDiagnosis.posology}" />

				</p:dialog>

				<p:dialog header="#{msg['cie_grp_medication']}"
					widgetVar="dlgMedicationPreview" resizable="false"
					id="dialogMedicationPreview" showEffect="fade" hideEffect="explode"
					modal="true" width="800">

					<p:dataTable id="dtbMedication" var="rec"
						value="#{historyBacking.medicationModel}"
						selection="#{historyBacking.selectedMedication}"
						rowKey="#{rec.id}" paginator="true" rows="15" style="width:100%"
						emptyMessage="#{msg['glb_no_records_found']}">

						<p:column selectionMode="multiple" style="width:18px" />

						<p:column headerText="#{msg['cie_grp_diagnosis']}">
							<h:outputLabel value="#{rec.crmCie.description}" />
						</p:column>

						<p:column headerText="#{msg['sal_material_code']}">
							<h:outputLabel value="#{rec.codMaterial}" />
						</p:column>

						<p:column headerText="#{msg['sal_material_descr']}">
							<h:outputLabel value="#{rec.descMaterial}" />
						</p:column>

						<p:column headerText="#{msg['sal_material_amount']}"
							style="width:100px">
							<pe:inputNumber value="#{rec.unit}" symbolPosition="s"
								decimalPlaces="0" style="width:100px" minValue="1" maxValue="99" />
						</p:column>

						<f:facet name="footer">
							<p:commandButton id="btnSelMaterial"
								oncomplete="dlgMedicine.show()" update=":form:dialogMedicine"
								disabled="#{historyBacking.disabledDiagnosis}"
								value="#{msg['btn_select']}" icon="ui-icon-search"
								actionListener="#{historyBacking.selectMedicationAction}" />
							<p:commandButton value="#{msg['btn_delete']}"
								disabled="#{historyBacking.disabledMedication}"
								icon="ui-icon-closethick" update="dtbMedication"
								actionListener="#{historyBacking.removeMedicationAction}" />
						</f:facet>

					</p:dataTable>

				</p:dialog>

				<p:defaultCommand target="btnSaveHistory" />

			</h:form>

		</p:panel>

	</ui:define>
</ui:composition>
</html>